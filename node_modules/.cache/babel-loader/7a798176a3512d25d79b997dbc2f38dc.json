{"ast":null,"code":"var _jsxFileName = \"/home/Panda21/Documents/Emory/2021 - 2022/CS 485/m4-search/m4-status-update-wii-design/src/components/scatterplot.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useEffect, useState } from \"react\";\nimport * as d3 from 'd3';\nimport { legendColor } from \"d3-svg-legend\";\nimport './scatterplot.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Scatterplot = dataSet => {\n  _s();\n\n  const svgRef = useRef();\n  const [data, setData] = useState([]);\n  const list = new Array();\n  const cat = useRef('Critic Score');\n  const num = useRef('North America Sales');\n  const optX = [{\n    value: 'Critic Score',\n    label: 'Critic Score'\n  }, {\n    value: 'User Score',\n    label: 'User Score'\n  }, {\n    value: 'Global Sales',\n    label: 'Global Sales'\n  }, {\n    value: 'North America Sales',\n    label: 'North America Sales'\n  }, {\n    value: 'Average Play Length_All PlayStyles',\n    label: 'Average All Playstyles Play Time'\n  }, {\n    value: 'Average Play Length_Leisure',\n    label: 'Average Leisure Play Time'\n  }];\n  const optY = [{\n    value: 'North America Sales',\n    label: 'North America Sales'\n  }, {\n    value: 'Average Play Length_All PlayStyles',\n    label: 'Average All Playstyles Play Time'\n  }, {\n    value: 'Average Play Length_Leisure',\n    label: 'Average Leisure Play Time'\n  }, {\n    value: 'Critic Score',\n    label: 'Critic Score'\n  }, {\n    value: 'User Score',\n    label: 'User Score'\n  }, {\n    value: 'Global Sales',\n    label: 'Global Sales'\n  }];\n  const optColor = [{\n    value: 'Genres',\n    label: 'Genres'\n  }, {\n    value: 'Platform',\n    label: 'Platform'\n  }, {\n    value: 'Developer',\n    label: 'Developer'\n  }, {\n    value: 'Rating',\n    label: 'Rating'\n  }];\n  const selectionStyle = {\n    display: 'flex',\n    margin: '20px'\n  };\n  const chartStyle = {\n    overflow: 'auto',\n    height: '500px',\n    width: '800px',\n    display: 'flex'\n  };\n  const tableStyle = {\n    align: 'center',\n    display: 'flex',\n    padding: '20px',\n    margin: '20px'\n  };\n  useEffect(() => {\n    d3.csv(\"/data/clean_data.csv\").then(da => {\n      var list1 = dataSet.dataSet.map(game => {\n        return game.row;\n      });\n      setData(list1);\n    });\n  }, [dataSet.dataSet]);\n  useEffect(() => {\n    d3.selectAll('circle').remove();\n    d3.selectAll('#legendArea').remove();\n    let labelX = '';\n    let labelY = ''; //set up color\n\n    const color = d3.scaleOrdinal().domain(data.map(function (d) {\n      return d['Genres'];\n    })).range(d3.schemeCategory10); //set up container\n\n    const w = 800;\n    const h = 400;\n    const margin = {\n      top: 20,\n      right: 20,\n      bottom: 30,\n      left: 40\n    };\n    const svg = d3.select(svgRef.current).attr('width', w).attr('height', h).style('overflow', 'visible').style('margin-top', '10px').style('margin-bottom', '50px').style('position', 'absolute').style('left', '100px').append('g'); //set options\n\n    d3.select('#x-cat').selectAll('option').data(optX).join('option').text(function (d) {\n      return d.label;\n    }).attr('value', function (d) {\n      return d.value;\n    }).attr('label', function (d) {\n      return d.label;\n    });\n    d3.select('#y-cat').selectAll('option').data(optY).join('option').text(function (d) {\n      return d.label;\n    }).attr('value', function (d) {\n      return d.value;\n    }).attr('label', function (d) {\n      return d.label;\n    });\n    d3.select('#color-cat').selectAll('option').data(optColor).join('option').text(function (d) {\n      return d.label;\n    }).attr('value', function (d) {\n      return d.value;\n    }).attr('label', function (d) {\n      return d.label;\n    }); //setting scales\n\n    const yScale = d3.scaleLinear().domain([0, d3.max(data, function (d) {\n      return d[num.current];\n    })]).range([h, 0]);\n    const xScale = d3.scaleLinear().domain([0, d3.max(data, function (d) {\n      return d[cat.current];\n    })]).range([0, w]); //set up legend\n\n    const legend = legendColor().shapeWidth(20).shapeHeight(5).scale(color);\n    d3.selectAll('#chartArea').append('div').attr('id', 'legendArea').style('height', '400px').style('width', '500px').style('position', 'absolute').style('left', '930px').style('overflow-y', 'scroll').append('svg').attr('id', 'legend').attr('height', '120vh').attr('width', '100vh').style('overflow', 'scroll').style('display', 'flex').call(legend); //set up zoom\n\n    const zoom = d3.zoom().scaleExtent([-5, 10]).extent([[0, 0], [w, h]]).on('zoom', zoomed); // rescaling\n\n    function zoomed(e) {\n      const newY = e.transform.rescaleY(yScale);\n      const newX = e.transform.rescaleX(xScale);\n      xAxis.call(d3.axisBottom(newX));\n      yAxis.call(d3.axisLeft(newY));\n      circle.selectAll('circle').attr('cy', function (d) {\n        return newY(d[num.current]);\n      }).attr('cx', function (d) {\n        return newX(d[cat.current]);\n      });\n    } //clipPath - nothing draw outside the area\n\n\n    svg.append('defs').append('svg:clipPath').attr(\"id\", \"clip\").append('svg:rect').attr('width', w).attr('height', h).attr('x', 0).attr('y', 0); //invisible rect on top of the chart to recover pointer events\n\n    svg.append('rect').attr('width', w).attr('height', h).style('fill', 'none').style('pointer-events', 'all').call(zoom); //set up axes\n\n    const xAxis = d3.select('#x-axis').attr('transform', `translate(0, ${h})`).call(d3.axisBottom(xScale));\n    const yAxis = d3.select('#y-axis') //.attr('transform', `translate(0, ${w})`)\n    .call(d3.axisLeft(yScale)); //set label\n\n    svg.append('text').attr('id', 'x-label').attr('x', w / 2).attr('y', h + 50).text('Critic Score');\n    svg.append('text').attr('id', 'y-label').attr('y', h - 450).attr('x', -320).attr(\"transform\", \"rotate(270)\").text('North America Sales'); //set up tooltip\n\n    const tooldiv = d3.select('#chartArea').append('div').style('visibility', 'hidden').style('position', 'absolute').style('background-color', '#ccc').style('padding', '10px').style('border-radius', '5px'); //setting up data\n\n    const circle = svg.append('g').attr(\"clip-path\", 'url(#clip)');\n    circle.selectAll('circle').data(data).join('circle').attr('cx', d => xScale(d[cat.current])).attr('cy', d => yScale(d[num.current])).attr('r', 5).attr('fill', d => color(d.Genres)).on('mouseover', (e, d) => {\n      d3.select(e.currentTarget).attr('r', 5 * 2).attr('fill', 'orange');\n      tooldiv.style('visibility', 'visible').text(`${d['Title']}`);\n    }).on('mousemove', (e, d) => {\n      tooldiv.style('top', e.pageY - 50 + 'px').style('left', e.pageX - 50 + 'px');\n    }).on('mouseout', (e, d) => {\n      d3.select(e.currentTarget).attr('r', 5).attr('fill', '#ff00ad');\n      tooldiv.style('visibility', 'hidden');\n    }).on('click', (e, d) => {\n      list.push(d);\n      var rows = tbody.selectAll(\"tr\").data(list).join('tr');\n      var cells = rows.selectAll('td').data(function (cell) {\n        return columns.map(function (game) {\n          return {\n            column: game,\n            value: cell[game]\n          };\n        });\n      }).enter().append('td').text(function (d) {\n        return d.value;\n      });\n    }); //update option\n\n    function updateX(selectedGroup) {\n      cat.current = selectedGroup;\n      console.log(cat.current + ' ' + num.current);\n      const newXScale = d3.scaleLinear().domain([0, d3.max(data, function (d) {\n        return d[cat.current];\n      })]).range([0, w]);\n      const newYScale = d3.scaleLinear().domain([0, d3.max(data, function (d) {\n        return d[num.current];\n      })]).range([h, 0]);\n      d3.select('#x-axis') //.attr('transform', `translate(0, ${h})`)\n      .call(d3.axisBottom(newXScale));\n      d3.select('#y-axis') //.attr('transform', `translate(0, ${w})`)\n      .call(d3.axisLeft().scale(yScale)); //set up zoom\n\n      const zoom = d3.zoom().scaleExtent([-5, 10]).extent([[0, 0], [w, h]]).on('zoom', zoomed);\n\n      function zoomed(e) {\n        const newY = e.transform.rescaleY(yScale);\n        const newX = e.transform.rescaleX(xScale);\n        xAxis.call(d3.axisBottom(newX));\n        yAxis.call(d3.axisLeft(newY));\n        circle.selectAll('circle').attr('cy', function (d) {\n          return newY(d[num.current]);\n        }).attr('cx', function (d) {\n          return newX(d[selectedGroup]);\n        });\n      }\n\n      svg.selectAll('rect').call(zoom);\n      circle.selectAll('circle').on('mouseover', (e, d) => {\n        if (selectedGroup !== 'Title') {\n          d3.select(e.currentTarget).attr('r', 5 * 2).attr('fill', 'orange');\n          tooldiv.style('visibility', 'visible').text(`Title: ${d['Title']}  ${labelX}: ${d[selectedGroup]}`);\n        } else {\n          d3.select(e.currentTarget).attr('r', 5 * 2).attr('fill', 'orange');\n          tooldiv.style('visibility', 'visible').text(`${d['Title']}`);\n        }\n      }).transition().duration(1000).attr('fill', d => color(d['Genres'])).attr('cx', function (d) {\n        return newXScale(d[selectedGroup]);\n      }).attr('cy', function (d) {\n        return newYScale(d[num.current]);\n      });\n    }\n\n    d3.select('#x-cat').on('change', function (e, d) {\n      const selectedOpt = d3.select(this).property('value');\n      labelX = e.target.selectedOptions[0].getAttribute('label');\n      d3.selectAll('#x-label').text(labelX);\n      updateX(selectedOpt);\n    });\n\n    function updateY(selectedGroup) {\n      num.current = selectedGroup;\n      console.log(cat.current + ' ' + num.current);\n      const newXScale = d3.scaleLinear().domain([0, d3.max(data, function (d) {\n        return d[cat.current];\n      })]).range([0, w]);\n      const newYScale = d3.scaleLinear().domain([0, d3.max(data, function (d) {\n        return d[selectedGroup];\n      })]).range([h, 0]);\n      d3.select('#y-axis').call(d3.axisLeft(newYScale));\n      d3.select('#x-axis').call(d3.axisBottom(newXScale)); //set up zoom\n\n      const zoom = d3.zoom().scaleExtent([-5, 10]).extent([[0, 0], [w, h]]).on('zoom', zoomed);\n\n      function zoomed(e) {\n        const newY = e.transform.rescaleY(yScale);\n        const newX = e.transform.rescaleX(xScale);\n        xAxis.call(d3.axisBottom(newX));\n        yAxis.call(d3.axisLeft(newY));\n        circle.selectAll('circle').attr('cy', function (d) {\n          return newY(d[selectedGroup]);\n        }).attr('cx', function (d) {\n          return newX(d[cat.current]);\n        });\n      }\n\n      svg.selectAll('rect').call(zoom);\n      circle.selectAll('circle').transition().duration(1000).attr('cy', d => newYScale(d[selectedGroup])).attr('cx', function (d) {\n        return newXScale(d[cat.current]);\n      }).attr('fill', d => color(d['Genres']));\n    }\n\n    d3.select('#y-cat').on('change', function (e, d) {\n      const selectedOpt = d3.select(this).property('value');\n      labelY = e.target.selectedOptions[0].getAttribute('label');\n      d3.selectAll('#y-label').text(labelY);\n      updateY(selectedOpt);\n    });\n\n    function updateColor(selectedGroup) {\n      const color = d3.scaleOrdinal().domain(data.map(function (d) {\n        return d[selectedGroup];\n      })).range(d3.schemeCategory10);\n      const legend = legendColor().shapeWidth(20).shapeHeight(5).scale(color);\n      d3.selectAll('#legendArea').remove();\n\n      if (selectedGroup === 'Rating') {\n        d3.selectAll('#chartArea').append('div').attr('id', 'legendArea').style('height', '400px').style('width', '500px').style('position', 'absolute').style('left', '930px').style('overflow-y', 'scroll').append('svg').attr('id', 'legend').style('overflow', 'scroll').style('display', 'flex').call(legend);\n      } else if (selectedGroup === 'Platform') {\n        d3.selectAll('#chartArea').append('div').attr('id', 'legendArea').style('height', '400px').style('width', '500px').style('position', 'absolute').style('left', '930px').style('overflow-y', 'scroll').append('svg').attr('id', 'legend').style('overflow', 'scroll').style('display', 'flex').call(legend);\n      } else if (selectedGroup === 'Developer') {\n        d3.selectAll('#chartArea').append('div').attr('id', 'legendArea').style('height', '400px').style('width', '500px').style('position', 'absolute').style('left', '930px').style('overflow-y', 'scroll').append('svg').attr('id', 'legend').attr('height', '90vh').style('overflow', 'scroll').style('display', 'flex').call(legend);\n      } else {\n        d3.selectAll('#chartArea').append('div').attr('id', 'legendArea').style('height', '400px').style('width', '500px').style('position', 'absolute').style('left', '930px').style('overflow-y', 'scroll').append('svg').attr('id', 'legend').attr('height', '120vh').attr('width', '100vh').style('overflow', 'scroll').style('display', 'flex').call(legend);\n      }\n\n      circle.selectAll('circle').attr('fill', d => color(d[selectedGroup]));\n    }\n\n    d3.select('#color-cat').on('change', function (e, d) {\n      const selectedOpt = d3.select(this).property('value');\n      updateColor(selectedOpt);\n    });\n    d3.selectAll('table').remove();\n    var table = d3.select(\"#tableArea\").append(\"table\");\n    var thead = table.append(\"thead\");\n    var tbody = table.append(\"tbody\");\n    const columns = ['Title', 'Year', 'Platform', 'Critic Score', 'User Score', 'Developer', 'Genres', 'Rating'];\n    thead.append(\"tr\").selectAll(\"th\").data(columns).join(\"th\").text(function (d) {\n      return d;\n    });\n  }, [data]);\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"selection\",\n      style: selectionStyle,\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Select X Value\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 522,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        id: \"x-cat\",\n        children: \"Select X Value\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 523,\n        columnNumber: 17\n      }, this), \"\\xA0\\xA0\", /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Select Y Value\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 524,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        id: \"y-cat\",\n        children: \"Select Y Value\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 525,\n        columnNumber: 17\n      }, this), \"\\xA0\\xA0\", /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Select Color Code\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 526,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        id: \"color-cat\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 527,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 521,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"chartArea\",\n      style: chartStyle,\n      children: /*#__PURE__*/_jsxDEV(\"svg\", {\n        ref: svgRef,\n        children: [/*#__PURE__*/_jsxDEV(\"g\", {\n          id: \"x-axis\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 531,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"g\", {\n          id: \"y-axis\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 530,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 529,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"tableArea\",\n      style: tableStyle\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 535,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 520,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Scatterplot, \"h/FVKb3wFnkb5UV+KME4H1+1w8Q=\");\n\n_c = Scatterplot;\nexport default Scatterplot;\n\nvar _c;\n\n$RefreshReg$(_c, \"Scatterplot\");","map":{"version":3,"sources":["/home/Panda21/Documents/Emory/2021 - 2022/CS 485/m4-search/m4-status-update-wii-design/src/components/scatterplot.js"],"names":["React","useRef","useEffect","useState","d3","legendColor","Scatterplot","dataSet","svgRef","data","setData","list","Array","cat","num","optX","value","label","optY","optColor","selectionStyle","display","margin","chartStyle","overflow","height","width","tableStyle","align","padding","csv","then","da","list1","map","game","row","selectAll","remove","labelX","labelY","color","scaleOrdinal","domain","d","range","schemeCategory10","w","h","top","right","bottom","left","svg","select","current","attr","style","append","join","text","yScale","scaleLinear","max","xScale","legend","shapeWidth","shapeHeight","scale","call","zoom","scaleExtent","extent","on","zoomed","e","newY","transform","rescaleY","newX","rescaleX","xAxis","axisBottom","yAxis","axisLeft","circle","tooldiv","Genres","currentTarget","pageY","pageX","push","rows","tbody","cells","cell","columns","column","enter","updateX","selectedGroup","console","log","newXScale","newYScale","transition","duration","selectedOpt","property","target","selectedOptions","getAttribute","updateY","updateColor","table","thead"],"mappings":"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","sourcesContent":["import React, {useRef, useEffect, useState} from \"react\";\nimport * as d3 from 'd3';\nimport {legendColor }from \"d3-svg-legend\";\nimport './scatterplot.css'\n\n\nconst Scatterplot = (dataSet) => {\n\n    const svgRef = useRef();\n    const [data, setData] = useState([]);\n    const list = new Array();\n    const cat = useRef('Critic Score');\n    const num = useRef('North America Sales')\n\n    const optX = [\n        {value: 'Critic Score', label: 'Critic Score'},\n        {value: 'User Score', label: 'User Score'},\n        {value: 'Global Sales', label: 'Global Sales'},\n        {value: 'North America Sales', label: 'North America Sales'},\n        {value: 'Average Play Length_All PlayStyles', label: 'Average All Playstyles Play Time'},\n        {value: 'Average Play Length_Leisure', label: 'Average Leisure Play Time'}\n    ]\n\n    const optY = [\n        {value: 'North America Sales', label: 'North America Sales'},\n        {value: 'Average Play Length_All PlayStyles', label: 'Average All Playstyles Play Time'},\n        {value: 'Average Play Length_Leisure', label: 'Average Leisure Play Time'},\n        {value: 'Critic Score', label: 'Critic Score'},\n        {value: 'User Score', label: 'User Score'},\n        {value: 'Global Sales', label: 'Global Sales'}\n    ]\n\n    const optColor = [\n        {value: 'Genres', label: 'Genres'},\n        {value: 'Platform', label:'Platform'},\n        {value: 'Developer', label:'Developer'},\n        {value: 'Rating', label: 'Rating'}\n    ]\n\n    const selectionStyle = {\n        display: 'flex',\n        margin: '20px'\n    }\n\n    const chartStyle = {\n        overflow: 'auto',\n        height: '500px',\n        width: '800px',\n        display:'flex',\n    }\n    const tableStyle = {\n        align: 'center',\n        display: 'flex',\n        padding: '20px',\n        margin: '20px'\n     }\n\n    useEffect(()=> {\n        d3.csv(\"/data/clean_data.csv\")\n            .then((da) =>{\n                var list1 = dataSet.dataSet.map((game)=>{\n                    return game.row;\n                })\n                setData(list1);\n        })\n    }, [dataSet.dataSet]);\n\n    useEffect(() => {\n\n        d3.selectAll('circle').remove()\n        d3.selectAll('#legendArea').remove()\n        let labelX = '';\n        let labelY = '';\n        //set up color\n        const color = d3.scaleOrdinal()\n            .domain(data.map(function(d) {return d['Genres']}))\n            .range(d3.schemeCategory10)\n\n        //set up container\n        const w = 800;\n        const h = 400;\n        const margin = {top:20, right:20, bottom:30, left:40};\n        const svg = d3.select(svgRef.current)\n            .attr('width', w)\n            .attr('height', h)\n            .style('overflow', 'visible')\n            .style('margin-top', '10px')\n            .style('margin-bottom', '50px')\n            .style('position', 'absolute')\n            .style('left', '100px')\n            .append('g')\n\n        //set options\n        d3.select('#x-cat')\n            .selectAll('option')\n                .data(optX)\n            .join('option')\n            .text(function(d){return d.label})\n            .attr('value', function(d){return d.value})\n            .attr('label', function(d){return d.label})\n\n        d3.select('#y-cat')\n            .selectAll('option')\n                .data(optY)\n            .join('option')\n            .text(function(d){return d.label})\n            .attr('value', function(d){return d.value})\n            .attr('label', function(d){return d.label})\n\n        d3.select('#color-cat')\n            .selectAll('option')\n                .data(optColor)\n            .join('option')\n            .text(function(d){return d.label})\n            .attr('value', function(d){return d.value})\n            .attr('label', function(d){return d.label})\n\n            //setting scales\n            const yScale = d3.scaleLinear()\n                .domain([0, d3.max(data, function(d) {return d[num.current]})])\n                .range([h,0]);\n\n            const xScale = d3.scaleLinear()\n                .domain([0, d3.max(data,function(d) {return d[cat.current]})])\n                .range([0,w])\n\n\n            //set up legend\n            const legend = legendColor()\n                .shapeWidth(20)\n                .shapeHeight(5)\n                .scale(color)\n\n            d3.selectAll('#chartArea')\n                .append('div')\n                .attr('id','legendArea')\n                .style('height', '400px')\n                .style('width', '500px')\n                .style('position', 'absolute')\n                .style('left', '930px')\n                .style('overflow-y', 'scroll')\n                .append('svg')\n                .attr('id', 'legend')\n                .attr('height', '120vh')\n                .attr('width', '100vh')\n                .style('overflow', 'scroll')\n                .style('display', 'flex')\n                .call(legend)\n\n            //set up zoom\n            const zoom = d3.zoom()\n            .scaleExtent([-5,10])\n            .extent([[0,0],[w,h]])\n            .on('zoom', zoomed);\n\n            // rescaling\n            function zoomed(e) {\n                const newY = e.transform.rescaleY(yScale)\n                const newX = e.transform.rescaleX(xScale)\n\n                xAxis.call(d3.axisBottom(newX))\n                yAxis.call(d3.axisLeft(newY))\n\n                circle\n                    .selectAll('circle')\n                    .attr('cy', function(d) {return newY(d[num.current])})\n                    .attr('cx', function(d) {return newX(d[cat.current])})\n            }\n    \n        \n            //clipPath - nothing draw outside the area\n\n            svg.append('defs').append('svg:clipPath')\n                .attr(\"id\", \"clip\")\n                .append('svg:rect')\n                .attr('width', w)\n                .attr('height',h)\n                .attr('x', 0)\n                .attr('y',0)\n\n            //invisible rect on top of the chart to recover pointer events\n            svg.append('rect')\n                .attr('width', w)\n                .attr('height',h)\n                .style('fill', 'none')\n                .style('pointer-events', 'all')\n                .call(zoom)\n\n\n            //set up axes\n            const xAxis = d3.select('#x-axis')\n                .attr('transform', `translate(0, ${h})`)\n                .call(d3.axisBottom(xScale))\n            \n            const yAxis = d3.select('#y-axis')\n                //.attr('transform', `translate(0, ${w})`)\n                .call(d3.axisLeft(yScale))\n\n            //set label\n            svg.append('text')\n                .attr('id','x-label')\n                .attr('x', w/2)\n                .attr('y', h+50)\n                .text('Critic Score')\n            \n            svg.append('text')\n                .attr('id', 'y-label')\n                .attr('y', h-450)\n                .attr('x', -320)\n                .attr(\"transform\", \"rotate(270)\")\n                .text('North America Sales')\n\n            //set up tooltip\n            const tooldiv = d3.select('#chartArea')\n                .append('div')\n                .style('visibility', 'hidden')\n                .style('position', 'absolute')\n                .style('background-color', '#ccc')\n                .style('padding', '10px')\n                .style('border-radius', '5px')\n\n            //setting up data\n            const circle = svg.append('g')\n            .attr(\"clip-path\", 'url(#clip)')\n            \n            circle\n                .selectAll('circle')\n                .data(data)\n                .join('circle')\n                    .attr('cx', d => xScale(d[cat.current]))\n                    .attr('cy', d => yScale(d[num.current]))\n                    .attr('r',5)\n                    .attr('fill', d=>color(d.Genres))\n                    .on('mouseover',(e,d) => {\n                        d3.select(e.currentTarget)\n                            .attr('r', 5*2)\n                            .attr('fill', 'orange')\n                        tooldiv.style('visibility','visible')\n                            .text(`${d['Title']}`)\n                    })\n                    .on('mousemove', (e,d)=>{\n                        tooldiv.style('top', (e.pageY-50) + 'px')\n                            .style('left', (e.pageX-50)+ 'px')\n                    })\n                    .on('mouseout', (e,d) => {\n                        d3.select(e.currentTarget)\n                            .attr('r', 5)\n                            .attr('fill', '#ff00ad')\n                        tooldiv.style('visibility','hidden')\n                    })\n                    .on('click', (e,d)=>{\n                        list.push(d)\n                        var rows = tbody.selectAll(\"tr\")\n                            .data(list)\n                            .join('tr')\n\n                        var cells = rows.selectAll('td')\n                            .data(function(cell) {\n                                return columns.map(function(game) {\n                                    return {\n                                        column: game,\n                                        value: cell[game]\n                                    }\n                                })\n                            }).enter()\n                            .append('td')\n                            .text(function(d) {\n                                return d.value;\n                            });\n                    })\n        \n        //update option\n        function updateX(selectedGroup) {\n            cat.current = selectedGroup\n            console.log(cat.current + ' ' + num.current)\n\n            const newXScale = d3.scaleLinear()\n                .domain([0, d3.max(data,function(d) {return d[cat.current]})])\n                .range([0,w])\n\n            const newYScale = d3.scaleLinear()\n                .domain([0, d3.max(data, function(d) {return d[num.current]})])\n                .range([h,0])\n\n            d3.select('#x-axis')\n                //.attr('transform', `translate(0, ${h})`)\n                .call(d3.axisBottom(newXScale))\n\n            d3.select('#y-axis')\n                //.attr('transform', `translate(0, ${w})`)\n                .call(d3.axisLeft().scale(yScale))\n\n            //set up zoom\n            const zoom = d3.zoom()\n            .scaleExtent([-5,10])\n            .extent([[0,0],[w,h]])\n            .on('zoom', zoomed);\n\n            function zoomed(e){\n                const newY = e.transform.rescaleY(yScale)\n                const newX = e.transform.rescaleX(xScale)\n\n                xAxis.call(d3.axisBottom(newX))\n                yAxis.call(d3.axisLeft(newY))\n\n                circle\n                    .selectAll('circle')\n                    .attr('cy', function(d) {return newY(d[num.current])})\n                    .attr('cx', function(d) {return newX(d[selectedGroup])})\n            }\n\n            svg.selectAll('rect')\n                .call(zoom)\n\n            circle\n                .selectAll('circle')\n                    .on('mouseover',(e,d) => {\n                        if(selectedGroup !== 'Title') {\n                            d3.select(e.currentTarget)\n                            .attr('r', 5*2)\n                            .attr('fill', 'orange')\n\n                            tooldiv.style('visibility','visible')\n                            .text(`Title: ${d['Title']}  ${labelX}: ${d[selectedGroup]}`)\n                        }\n                        else {\n                            d3.select(e.currentTarget)\n                            .attr('r', 5*2)\n                            .attr('fill', 'orange')\n\n                            tooldiv.style('visibility','visible')\n                            .text(`${d['Title']}`)\n                        }\n\n                    })\n                .transition()\n                .duration(1000)\n                .attr('fill', d=>color(d['Genres']))\n                .attr('cx', function(d){return newXScale(d[selectedGroup])})    \n                .attr('cy', function(d){return newYScale(d[num.current])})\n            \n        }\n\n        d3.select('#x-cat').on('change', function(e,d) {\n            const selectedOpt = d3.select(this).property('value')\n            labelX = e.target.selectedOptions[0].getAttribute('label')\n            d3.selectAll('#x-label').text(labelX)\n            updateX(selectedOpt);\n        })\n\n        function updateY(selectedGroup) {\n            num.current = selectedGroup\n            console.log(cat.current + ' ' + num.current)\n\n            const newXScale = d3.scaleLinear()\n                .domain([0, d3.max(data,function(d) {return d[cat.current]})])\n                .range([0,w])\n\n            const newYScale = d3.scaleLinear()\n                .domain([0, d3.max(data,function(d){return d[selectedGroup]})])\n                .range([h,0])\n\n            d3.select('#y-axis')\n                .call(d3.axisLeft(newYScale))\n\n            d3.select('#x-axis')\n                .call(d3.axisBottom(newXScale))\n\n                //set up zoom\n            const zoom = d3.zoom()\n            .scaleExtent([-5,10])\n            .extent([[0,0],[w,h]])\n            .on('zoom', zoomed);\n\n            function zoomed(e){\n                const newY = e.transform.rescaleY(yScale)\n                const newX = e.transform.rescaleX(xScale)\n\n                xAxis.call(d3.axisBottom(newX))\n                yAxis.call(d3.axisLeft(newY))\n\n                circle\n                    .selectAll('circle')\n                    .attr('cy', function(d) {return newY(d[selectedGroup])})\n                    .attr('cx', function(d) {return newX(d[cat.current])})\n            }\n\n            svg.selectAll('rect')\n                .call(zoom)\n\n            circle\n                .selectAll('circle')\n                .transition()\n                .duration(1000)\n                .attr('cy', d=> newYScale(d[selectedGroup]))\n                .attr('cx', function(d){return newXScale(d[cat.current])})\n                .attr('fill', d=>color(d['Genres']))\n            \n        }\n        d3.select('#y-cat').on('change', function(e,d) {\n            const selectedOpt = d3.select(this).property('value');\n            labelY = e.target.selectedOptions[0].getAttribute('label')\n            d3.selectAll('#y-label').text(labelY);\n            updateY(selectedOpt);\n        })\n        function updateColor(selectedGroup) {\n\n            const color = d3.scaleOrdinal()\n                .domain(data.map(function(d) {return d[selectedGroup]}))\n                .range(d3.schemeCategory10)\n\n                const legend = legendColor()\n                .shapeWidth(20)\n                .shapeHeight(5)\n                .scale(color)\n\n            d3.selectAll('#legendArea').remove()\n            \n            if(selectedGroup === 'Rating') {\n                d3.selectAll('#chartArea')\n                .append('div')\n                .attr('id','legendArea')\n                .style('height', '400px')\n                .style('width', '500px')\n                .style('position', 'absolute')\n                .style('left', '930px')\n                .style('overflow-y', 'scroll')\n                .append('svg')\n                .attr('id', 'legend')\n                .style('overflow', 'scroll')\n                .style('display', 'flex')\n                .call(legend)\n            }\n            else if (selectedGroup === 'Platform') {\n                d3.selectAll('#chartArea')\n                .append('div')\n                .attr('id','legendArea')\n                .style('height', '400px')\n                .style('width', '500px')\n                .style('position', 'absolute')\n                .style('left', '930px')\n                .style('overflow-y', 'scroll')\n                .append('svg')\n                .attr('id', 'legend')\n                .style('overflow', 'scroll')\n                .style('display', 'flex')\n                .call(legend)\n            }\n            else if(selectedGroup === 'Developer') {\n                d3.selectAll('#chartArea')\n                .append('div')\n                .attr('id','legendArea')\n                .style('height', '400px')\n                .style('width', '500px')\n                .style('position', 'absolute')\n                .style('left', '930px')\n                .style('overflow-y', 'scroll')\n                .append('svg')\n                .attr('id', 'legend')\n                .attr('height', '90vh')\n                .style('overflow', 'scroll')\n                .style('display', 'flex')\n                .call(legend)\n            }\n            else {\n            d3.selectAll('#chartArea')\n                .append('div')\n                .attr('id','legendArea')\n                .style('height', '400px')\n                .style('width', '500px')\n                .style('position', 'absolute')\n                .style('left', '930px')\n                .style('overflow-y', 'scroll')\n                .append('svg')\n                .attr('id', 'legend')\n                .attr('height', '120vh')\n                .attr('width', '100vh')\n                .style('overflow', 'scroll')\n                .style('display', 'flex')\n                .call(legend)\n            }\n\n            circle\n                .selectAll('circle')\n                .attr('fill', d => color(d[selectedGroup]))\n        }\n\n        d3.select('#color-cat').on('change', function(e,d) {\n            const selectedOpt = d3.select(this).property('value')\n            updateColor(selectedOpt);\n        })\n\n        d3.selectAll('table').remove()\n        var table = d3.select(\"#tableArea\").append(\"table\")\n        var thead = table.append(\"thead\")\n        var tbody = table.append(\"tbody\")\n\n        const columns = [\n            'Title',\n            'Year',\n            'Platform',\n            'Critic Score',\n            'User Score',\n            'Developer',\n            'Genres',\n            'Rating'\n         ]\n\n        thead.append(\"tr\")\n            .selectAll(\"th\")\n            .data(columns)\n            .join(\"th\")\n            .text(function(d) {\n                return d;\n            })\n   \n    }, [data]);\n\n    return(\n        <React.Fragment>\n            <div className='selection' style={selectionStyle}>\n                <p>Select X Value</p>\n                <select id='x-cat'>Select X Value</select>&nbsp;&nbsp;\n                <p>Select Y Value</p>\n                <select id= 'y-cat'>Select Y Value</select>&nbsp;&nbsp;\n                <p>Select Color Code</p>\n                <select id= 'color-cat'></select>\n            </div>\n            <div id = 'chartArea' style={chartStyle}>\n                <svg ref = {svgRef}>\n                    <g id ='x-axis'></g>\n                    <g id = 'y-axis'></g>\n                </svg>\n            </div>\n            <div id = 'tableArea' style={tableStyle}></div>\n\n            \n        </React.Fragment>\n    )\n}\n\nexport default Scatterplot;\n"]},"metadata":{},"sourceType":"module"}